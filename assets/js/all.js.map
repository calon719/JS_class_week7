{"version":3,"sources":["all.js"],"names":["addTicketInputs","document","querySelectorAll","addTicketBtn","querySelector","cardList","searchAreaInput","searchResultNum","ticketData","areaChartData","addEventListener","checkInput","areaFilter","axios","get","then","response","data","renderData","updateChart","error","console","log","e","preventDefault","checkStatus","forEach","item","inputSpan","getAttribute","descriptionSpan","parseInt","value","setAttribute","length","addTicket","obj","id","push","inputValue","searchResultData","filter","area","str","resultNum","imgUrl","rate","name","description","group","price","innerHTML","textContent","splice","areaData","aryCheck","some","itemCheck","num","aryItem","ary","chart","c3","generate","bindto","columns","type","donut","title","width","label","show","size","height"],"mappings":"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","file":"all.js","sourcesContent":["const addTicketInputs = document.querySelectorAll('[data-prop=\"ticketInput\"]');\nconst addTicketBtn = document.querySelector('#addTicketBtn');\nconst cardList = document.querySelector('.ticketList');\nconst searchAreaInput = document.querySelector('.searchRegion');\nconst searchResultNum = document.querySelector('.searchResultNum');\n\n// 資料\nlet ticketData;\nlet areaChartData = [];\n\naddTicketBtn.addEventListener('click', checkInput);\nsearchAreaInput.addEventListener('change', areaFilter);\n;\n\naxios.get('https://raw.githubusercontent.com/hexschool/js-training/main/travelApi.json').then(function (response) {\n  ticketData = response.data.data;\n  renderData(ticketData);\n  updateChart(ticketData);\n}).catch(function (error) {\n  console.log(error);\n});\n\nfunction checkInput(e) {\n  e.preventDefault();\n  let checkStatus = true;\n\n  addTicketInputs.forEach(function (item) {\n    let inputSpan = document.querySelector(`span[data-ticketInput=${item.getAttribute('data-ticketInput')}]`);\n    let descriptionSpan = document.querySelector(`span[data-ticketInput=\"descriptionNum\"]`);\n    if (item.getAttribute('data-ticketInput') == 'rate') {\n      // 檢查 套票星級\n      if (parseInt(item.value) > 10 || parseInt(item.value) < 1 || item.value === '') {\n        inputSpan.setAttribute('class', 'block mt-1 mb-2 text-tiny text-danger');\n        checkStatus = false;\n      } else {\n        inputSpan.setAttribute('class', 'invisible block mb-2 text-tiny text-danger');\n      };\n    } else if (item.getAttribute('data-ticketInput') === 'description') {\n      // 檢查 套票描述 字數\n      if (item.value === '') {\n        inputSpan.setAttribute('class', 'visible block text-tiny text-danger mb-0.5');\n      } else if (item.value.length > 100) {\n        inputSpan.setAttribute('class', 'hidden');\n        descriptionSpan.setAttribute('class', 'block mb-2 text-tiny text-danger')\n        checkStatus = false;\n      } else {\n        descriptionSpan.setAttribute('class', 'hidden');\n        inputSpan.setAttribute('class', 'invisible block text-tiny mb-0.5');\n      };\n    } else if (item.value === '') {\n      // 檢查空值\n      inputSpan.setAttribute('class', 'block mt-1 mb-2 text-tiny text-danger');\n      checkStatus = false;\n    } else {\n      inputSpan.setAttribute('class', 'invisible block text-tiny mb-0.5');\n    };\n  });\n\n  addTicket(checkStatus);\n};\n\n// 新增資料到 物件 data\nfunction addTicket(checkStatus) {\n  if (checkStatus) {\n    let obj = {};\n\n    addTicketInputs.forEach(function (item) {\n      obj.id = ticketData.length;\n      if (item.getAttribute('type') === 'number') {\n        obj[item.getAttribute('data-ticketInput')] = parseInt(item.value);\n      } else {\n        obj[item.getAttribute('data-ticketInput')] = item.value;\n      };\n      item.value = '';\n    });\n    ticketData.push(obj);\n    areaFilter(); // 更新畫面\n    updateChart(ticketData); // 更新圖表\n  } else {\n    return;\n  }\n};\n\n// 篩選資料\n// 篩選後會顯示『搜尋資料為 ? 筆』\nfunction areaFilter() {\n  let inputValue = searchAreaInput.value;\n  let searchResultData;\n\n  if (inputValue === '' || inputValue === '全部') {\n    searchResultData = ticketData;\n  } else {\n    searchResultData = ticketData.filter(function (item) {\n      return item.area === inputValue;\n    });\n  };\n  renderData(searchResultData);\n};\n\n// 組裝字串、渲染畫面\nfunction renderData(data) {\n  let str = '';\n  let resultNum = 0;\n  data.forEach(function (item) {\n    resultNum++;\n    str += `\n      <li class=\"flex flex-col bg-white transform hover:scale-105 transition-all duration-700 ease-out rounded relative shadow\">\n        <div class=\"bg-secondary text-white text-xl rounded-r py-2 px-5 absolute -top-5 left-0\">${item.area}</div>\n        <div class=\"h-45 bg-no-repeat bg-cover bg-center rounded-t\"style=\"background-image: url('${item.imgUrl}');\"></div>\n        <div class=\"relative text-primary pt-5 pb-4 px-5 flex flex-grow flex-col justify-between\">\n          <div class=\"absolute bg-primary text-white w-10 text-center rounded-r py-1 -top-4 left-0\">${item.rate}</div>\n          <div>\n            <h2 class=\"font-bold text-2xl pb-1 mb-4 border-b-2\">${item.name}</h2>\n            <p class=\"text-gray-500 mb-8 break-words\">${item.description}</p>\n          </div>\n          <div class=\"flex justify-between items-center\">\n            <p><i class=\"fas fa-exclamation-circle\"></i><span class=\"font-medium\">剩下最後 ${item.group} 組</span></p>\n            <p class=\"font-medium flex items-center\">TWD<span class=\"text-4xl ml-1\">$${item.price}</span></p>\n          </div>\n        </div>\n      </li>\n    `;\n  });\n  cardList.innerHTML = str;\n  searchResultNum.textContent = resultNum;\n};\n\n\n// 更新甜甜圈圖表\nfunction updateChart(data) {\n  areaChartData.splice(0)\n  let areaData = [];\n\n  data.forEach(function (item) {\n    let obj = {};\n    let aryCheck = areaData.some(function (itemCheck) { return itemCheck.area === item.area });\n    if (areaData.length === 0 || !aryCheck) {\n      obj.area = item.area;\n      obj.num = 1;\n      areaData.push(obj);\n    } else {\n      areaData.forEach(function (aryItem) {\n        if (aryItem.area === item.area) {\n          aryItem.num += 1;\n        };\n      });\n    };\n  });\n\n  areaData.forEach(function (item) {\n    let ary = [];\n    ary.push(item.area, item.num)\n    areaChartData.push(ary);\n  });\n\n  let chart = c3.generate({\n    bindto: '.areaChart',\n    data: {\n      columns: areaChartData,\n      type: 'donut'\n    },\n    donut: {\n      title: '套票地區比重',\n      width: 10,\n      label: {\n        show: false\n      }\n    },\n    size: {\n      height: 180,\n      width: 160\n    },\n  });\n}"]}